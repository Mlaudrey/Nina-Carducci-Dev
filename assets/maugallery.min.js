(function($){$.fn.mauGallery=function(options){var opts=$.extend($.fn.mauGallery.defaults,options);var tags=[];return this.each(function(){$.fn.mauGallery.methods.createRowWrapper($(this));if(opts.lightBox){$.fn.mauGallery.methods.createLightBox($(this),opts.lightboxId,opts.navigation);}$.fn.mauGallery.listeners(opts);$(this).children(".gallery-item").each(function(){$.fn.mauGallery.methods.responsiveImageItem($(this));$.fn.mauGallery.methods.moveItemInRowWrapper($(this));$.fn.mauGallery.methods.wrapItemInColumn($(this),opts.columns);var tag=$(this).data("gallery-tag");if(opts.showTags&&tag!==undefined&&tags.indexOf(tag)===-1){tags.push(tag);}});if(opts.showTags){$.fn.mauGallery.methods.showItemTags($(this),opts.tagsPosition,tags);}$(this).fadeIn(500);});};$.fn.mauGallery.defaults={columns:3,lightBox:true,lightboxId:null,showTags:true,tagsPosition:"bottom",navigation:true};$.fn.mauGallery.listeners=function(opts){$(".gallery-item").on("click",function(){if(opts.lightBox&&$(this).prop("tagName")==="IMG"){$.fn.mauGallery.methods.openLightBox($(this),opts.lightboxId);}else{return;}});$(".gallery").on("click",".nav-link",$.fn.mauGallery.methods.filterByTag);$(".gallery").on("click",".mg-prev",()=>$.fn.mauGallery.methods.prevImage(opts.lightboxId));$(".gallery").on("click",".mg-next",()=>$.fn.mauGallery.methods.nextImage(opts.lightboxId));};$.fn.mauGallery.methods={createRowWrapper:function(el){if(!el.children().first().hasClass("row")){el.append('<div class="gallery-items-row row"></div>');}},wrapItemInColumn:function(el,cols){if(typeof cols==="number"){el.wrap(`<div class='item-column mb-4 col-${Math.ceil(12/cols)}'></div>`);}else if(typeof cols==="object"){var cls="";if(cols.xs){cls+=` col-${Math.ceil(12/cols.xs)}`;}if(cols.sm){cls+=` col-sm-${Math.ceil(12/cols.sm)}`;}if(cols.md){cls+=` col-md-${Math.ceil(12/cols.md)}`;}if(cols.lg){cls+=` col-lg-${Math.ceil(12/cols.lg)}`;}if(cols.xl){cls+=` col-xl-${Math.ceil(12/cols.xl)}`;}el.wrap(`<div class='item-column mb-4${cls}'></div>`);}else{console.error(`Columns should be numbers or objects. ${typeof cols} is not supported.`);}},moveItemInRowWrapper:function(el){el.appendTo(".gallery-items-row");},responsiveImageItem:function(el){if(el.prop("tagName")==="IMG"){el.addClass("img-fluid");}},openLightBox:function(el,id){$(`#${id}`).find(".lightboxImage").attr("src",el.attr("src"));$(`#${id}`).modal("toggle");},prevImage:function(){var activeImg=null;$("img.gallery-item").each(function(){if($(this).attr("src")===$(".lightboxImage").attr("src")){activeImg=$(this);}});var tag=$(".tags-bar span.active-tag").data("images-toggle");var imgs=[];if(tag==="all"){$(".item-column").each(function(){if($(this).children("img").length){imgs.push($(this).children("img"));}});}else{$(".item-column").each(function(){if($(this).children("img").data("gallery-tag")===tag){imgs.push($(this).children("img"));}});}var i=0,next=null;$(imgs).each(function(n){if($(activeImg).attr("src")===$(this).attr("src")){i=n;}});next=imgs[i-1]||imgs[imgs.length-1];$(".lightboxImage").attr("src",$(next).attr("src"));},nextImage:function(){var activeImg=null;$("img.gallery-item").each(function(){if($(this).attr("src")===$(".lightboxImage").attr("src")){activeImg=$(this);}});var tag=$(".tags-bar span.active-tag").data("images-toggle");var imgs=[];if(tag==="all"){$(".item-column").each(function(){if($(this).children("img").length){imgs.push($(this).children("img"));}});}else{$(".item-column").each(function(){if($(this).children("img").data("gallery-tag")===tag){imgs.push($(this).children("img"));}});}var i=0,next=null;$(imgs).each(function(n){if($(activeImg).attr("src")===$(this).attr("src")){i=n;}});next=imgs[i+1]||imgs[0];$(".lightboxImage").attr("src",$(next).attr("src"));},createLightBox:function(gallery,id,navigation){gallery.append(`<div class="modal fade" id="${id||"galleryLightbox"}" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-body">${navigation?'<div class="mg-prev" style="cursor:pointer;position:absolute;top:50%;left:-15px;background:white;"><</div>':'<span style="display:none;" />'}<img class="lightboxImage img-fluid" alt="Contenu de l\'image affichÃ©e dans la modale au clique"/>${navigation?'<div class="mg-next" style="cursor:pointer;position:absolute;top:50%;right:-15px;background:white;}">></div>':'<span style="display:none;" />'}</div></div></div></div>`);},showItemTags:function(gallery,pos,tags){var tagItems='<li class="nav-item"><span class="nav-link active active-tag" data-images-toggle="all">Tous</span></li>';$.each(tags,function(i,v){tagItems+=`<li class="nav-item"><span class="nav-link" data-images-toggle="${v}">${v}</span></li>`;});var tagsRow=`<ul class="my-4 tags-bar nav nav-pills">${tagItems}</ul>`;if(pos==="bottom"){gallery.append(tagsRow);}else if(pos==="top"){gallery.prepend(tagsRow);}else{console.error(`Unknown tags position: ${pos}. Possible values are 'top' and 'bottom'.`);}},filterByTag:function(){$(".tags-bar span").removeClass("active active-tag");$(this).addClass("active active-tag");var tag=$(this).data("images-toggle");$(".item-column").each(function(){if(tag==="all"){$(this).show(400);}else if($(this).children().data("gallery-tag")!==tag){$(this).hide(400);}else{$(this).show(400);}})}};})(jQuery);
